{"componentChunkName":"component---src-templates-post-tsx","path":"/secrets키설정/","result":{"data":{"markdownRemark":{"html":"<h2 id=\"github-action에서-api-key값-설정하기\" style=\"position:relative;\"><a href=\"#github-action%EC%97%90%EC%84%9C-api-key%EA%B0%92-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\" aria-label=\"github action에서 api key값 설정하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>GitHub Action에서 API Key값 설정하기</h2>\n<hr>\n<h3 id=\"문제\" style=\"position:relative;\"><a href=\"#%EB%AC%B8%EC%A0%9C\" aria-label=\"문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>문제</h3>\n<p>프로젝트 개발 시 <code class=\"language-text\">.env</code>파일에 Server 주소, API key를 설정하여 사용하고 있었다. 해당 값들의 경우 Github 저장소에 공개되면 안되므로 해당 부분을 GitHub저장소에 올릴 수가 없었으며, 이에 대책으로 GitHub Secrets에 저장하여 변수로 사용하고자 하였다.</p>\n<h3 id=\"방안\" style=\"position:relative;\"><a href=\"#%EB%B0%A9%EC%95%88\" aria-label=\"방안 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>방안</h3>\n<p>Secrets에 저장한 프로젝트의 경우 GitHub Action을 사용하고 있었으며, 해당 프로세스의 경우 리눅스 기반환경으로 shell이 수행되고 있었다. GitHub에 저장된 Key-Value를 <code class=\"language-text\">secrets.[Key이름]</code>문법으로 제공해주고 있었으며, 이러한 값을 사용하여 <code class=\"language-text\">.env</code>파일에 Server주소, API key값을 동적으로 설정하고자 하였다.</p>\n<ol>\n<li>\n<p>환경변수의 값 비공개화</p>\n<ul>\n<li>GitHub의 Secrets를 사용</li>\n</ul>\n</li>\n<li>\n<p><code class=\"language-text\">.env</code>파일에 동적으로 환경변수의 값을 설정</p>\n<ul>\n<li>리눅스 명령어 <code class=\"language-text\">sed</code>를 사용</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"해결\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0\" aria-label=\"해결 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결</h3>\n<p>아래와 같이 GitHub Action에서 저장소에 저장된 Secrets 값을 가져온다.</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">SERVER</span><span class=\"token punctuation\">:</span> $<span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> secrets.REACT_APP_SERVER <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 가져온 값의 경우 GitHub Action이 수행되는 동안 전역변수와 같이 사용되게 된다. 이렇게 가져온 값에 대하여 <code class=\"language-text\">sed</code>명령어를 사용하여 특정 줄에서 정규식을 통해 찾은 단어 뒤에 Secrets에서 가져온 값을 삽입한다.</p>\n<blockquote>\n<p>💡리눅스(mac)에서는 <code class=\"language-text\">/</code>가 정상적으로 동작하나, GitHub Action에서의 ubuntu 환경에서는 <code class=\"language-text\">/</code>가 인식이 되지않아 <code class=\"language-text\">#</code>으로 대체하여 사용해야 했다. (<code class=\"language-text\">#</code>과 <code class=\"language-text\">/</code>는 리눅스에서 동일한 의미를 가진다.)</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> set .env.* file\n    <span class=\"token key atrule\">run</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">|</span><span class=\"token scalar string\">\n        sed -i \"1s#=#&amp;$SERVER#\" .env.production\n        sed -i \"2s#=#&amp;$NAVER_MAP_KEY#\" .env.production\n        sed -i \"1s#=#&amp;$SERVER#\" .env.development\n        sed -i \"2s#=#&amp;$NAVER_MAP_KEY#\" .env.development</span></code></pre></div>\n<p>위와 같이 수행 시 숫자에 해당하는 줄에서 <code class=\"language-text\">=</code>을 찾아서 해당 단어 뒤에 Secrets에서 가져온 값을 Insert하라는 의미이다.</p>\n<h3 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h3>\n<ol>\n<li><code class=\"language-text\">.env</code>환경변수의 값에 대해서는 비공개를 해야하므로, 사용하는 CI/CD환경에 해당 값들을 비공개로 저장한다.</li>\n<li>동적으로 넣을 시 리눅스 환경에서는 <code class=\"language-text\">sed</code>를 사용하여 값을 파일에 설정 할 수 있다.</li>\n</ol>","excerpt":"GitHub Action에서 API Key값 설정하기 문제 프로젝트 개발 시 파일에 Server 주소, API key를 설정하여 사용하고 있었다. 해당 값들의 경우 Github 저장소에 공개되면 안되므로 해당 부분을 GitHub…","tableOfContents":"<ul>\n<li>\n<p><a href=\"/secrets%ED%82%A4%EC%84%A4%EC%A0%95/#github-action%EC%97%90%EC%84%9C-api-key%EA%B0%92-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0\">GitHub Action에서 API Key값 설정하기</a></p>\n<ul>\n<li><a href=\"/secrets%ED%82%A4%EC%84%A4%EC%A0%95/#%EB%AC%B8%EC%A0%9C\">문제</a></li>\n<li><a href=\"/secrets%ED%82%A4%EC%84%A4%EC%A0%95/#%EB%B0%A9%EC%95%88\">방안</a></li>\n<li><a href=\"/secrets%ED%82%A4%EC%84%A4%EC%A0%95/#%ED%95%B4%EA%B2%B0\">해결</a></li>\n<li><a href=\"/secrets%ED%82%A4%EC%84%A4%EC%A0%95/#%EA%B2%B0%EB%A1%A0\">결론</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/secrets키설정/"},"frontmatter":{"title":"GitHub Action에서 API Key값 설정하기","date":"Aug 03, 2020","tags":["GitHub Action"],"keywords":["GitHub","GitHub Action","Secrets","API Key"]}}},"pageContext":{"slug":"/secrets키설정/","series":[]}}}